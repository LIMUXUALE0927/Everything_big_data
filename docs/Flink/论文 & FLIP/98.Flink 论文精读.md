# Flink 论文精读

[Apache Flink™: Stream and Batch Processing in a Single Engine](https://asterios.katsifodimos.com/assets/publications/flink-deb.pdf)

[论文精读文档](https://logikosto.feishu.cn/docx/JLjGdocinoJwm3xeITycc7grnXf?302from=wiki)

[论文精读视频](https://www.bilibili.com/video/BV11P41167qH/?spm_id_from=333.999.0.0&vd_source=f3af28d1fd89af1eb80db058885d7130)

## Memory Management

​Flink 基于数据库技术将数据序列化为内存段，而不是在 JVM 的堆中分配对象来表示缓冲的传输中的数据记录。**排序和连接等操作尽可能直接在二进制数据上操作**，将序列化和反序列化的开销降到**最低并在需要时部分将数据溢写到磁盘上**。为了处理任意对象，Flink 使用类型推断和自定义序列化机制。**通过将数据处理保持在二进制表示并在堆外处理**，Flink 成功地减少了垃圾收集的开销，并使用高效的缓存和可靠的算法在内存压力下良好扩展。

在 Flink 中，内存管理是通过 JVM 的垃圾回收机制来进行的。Flink 会根据任务的需求和可用的内存资源进行内存的分配和释放。Flink 使用了一些内存优化技术，包括：

1. **内存管理策略**：
   : Flink 提供了不同的内存管理策略，例如堆内存管理和堆外内存管理。堆内存管理使用 JVM 的堆内存来存储数据和运行时对象，而堆外内存管理将大规模数据存储在 JVM 堆之外，以减少垃圾回收的压力。
2. **基于内存的排序**：
   : 对于排序等操作，Flink 使用内存进行排序，以减少磁盘访问和提高数据处理速度。Flink 使用外部排序算法和归并排序算法来实现基于内存的排序，**对数据的处理尽可能的使用原始的二进制数据进行，尽可能的减少序列化与反序列化的开销**。
3. **压缩算法**：
   : Flink 支持对内存中的数据进行压缩，以减少数据在内存中的占用空间。压缩算法可以根据数据类型和压缩比例进行选择，从而减少内存使用和网络传输开销。
4. **内存管理器**：
   : Flink 提供了内存管理器来管理内存的分配和释放。内存管理器负责动态管理内存区域，并将内存分配给不同的任务和数据结构。此外，内存管理器还提供了内存重用机制，以减少内存分配和垃圾回收的开销。

这些内存优化技术帮助 Flink 在处理大规模数据时减少内存开销，提高处理性能和效率。
